<!DOCTYPE html>
<html lang="fa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Test CAPTCHA</title>
</head>
<body>
<h1>تست Google reCAPTCHA</h1>

<div id="captcha"></div>
<div id="status"></div>
<button id="check">بررسی توکن</button>

<script>
  const SITEKEY = "6LeHPiIsAAAAAMDYduGnHAheksdhXcMOFWvSdgLb"; // Site Key خودت

  // بارگذاری script reCAPTCHA با callback
  function loadRecaptcha() {
    const s = document.createElement("script");
    s.src = "https://www.google.com/recaptcha/api.js?onload=recaptchaReady&render=explicit";
    s.async = true;
    s.defer = true;
    document.head.appendChild(s);
  }

  window.recaptchaReady = function() {
    if (window.grecaptcha && window.grecaptcha.render) {
      window.widgetId = grecaptcha.render("captcha", {
        sitekey: SITEKEY,
        callback: function(token) {
          document.getElementById("status").textContent = "توکن تولید شد: " + token;
        }
      });
    }
  };

  loadRecaptcha();

  // دکمه تست توکن
  document.getElementById("check").addEventListener("click", function() {
    if (window.grecaptcha && window.widgetId !== undefined) {
      const token = grecaptcha.getResponse(window.widgetId);
      if (token) {
        alert("توکن معتبر: " + token);
      } else {
        alert("Captcha هنوز تایید نشده است!");
      }
    }
  });
</script>
</body>
</html>
